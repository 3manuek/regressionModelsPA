---
title: "Regression Models Peer Assessment"
author: "Emanuel Calvo"
date: "November 21, 2015"
# output: pdf_document
output: html_document
---

## Context

You work for Motor Trend, a magazine about the automobile industry. Looking at a data set of a collection of cars, they are interested in exploring the relationship between a set of variables and miles per gallon (MPG) (outcome). They are particularly interested in the following two questions:

- Is an automatic or manual transmission better for MPG
- Quantify the MPG difference between automatic and manual transmissions
    
Take the mtcars data set and write up an analysis to answer their question using regression models and exploratory data analyses.

Your report must be:

- Written as a PDF printout of a compiled (using knitr) R markdown document.
- Brief. Roughly the equivalent of 2 pages or less for the main text. Supporting figures in an appendix can be included up to 5 total pages including the 2 for the main report. The appendix can only include figures.
- Include a first paragraph executive summary.

## Executive Summary

### Dataset description 

The data was extracted from the 1974 Motor Trend US magazine, and comprises fuel consumption and 10 aspects of automobile design and performance for 32 automobiles (1973â€“74 models).
    
## Exploratory data analysis

```{r, echo =FALSE, message = FALSE}
library(datasets)
library(plyr)
library(dplyr)
require(graphics)
library(car)
library(GGally)

data("mtcars")
mpg <- mtcars$mpg
am <- mtcars$am
amS <- revalue(factor(mtcars$am), c("1"="Manual", "0"="Automatic"))
```


All the correlations against mpg:

```{r}
cor(mtcars)[1,]
```


Correlations:

```{r}
cor(mpg,am)

scatterplotMatrix(~ income + education + prestige | type, data=Duncan)
scatterplotMatrix(~ income + education + prestige, 
    transform=TRUE, data=Duncan, smoother=loessLine)
scatterplotMatrix(~ income + education + prestige | type, smoother=FALSE, 
	by.group=TRUE, transform=TRUE, data=Duncan)

spm(~ round(hp) + cyl | round(mpg),data = mtcars)

```

```{r, cache=TRUE}
g <- ggpairs(mtcars[,c("mpg","hp","cyl","am", "gear","carb","wt")], title = "Correlations" )
  plot <- ggplot2::ggplot(mtcars, ggplot2::aes(x=wt, y=mpg, label=rownames(mtcars)))
  plot <- plot +
    ggplot2::geom_text(ggplot2::aes(colour=factor(cyl)), size = 3) +
    ggplot2::scale_colour_discrete(l=40)
g <- putPlot(g, plot, 1, 2)

g2 <- ggplot2::ggplot(mtcars, ggplot2::aes(x=wt, y=mpg, label=rownames(mtcars))) +
      ggplot2::geom_text(ggplot2::aes(colour=factor(cyl)), size = 3) +
      ggplot2::scale_colour_discrete(l=40)
g2

g3 <- ggplot2::ggplot(mtcars, ggplot2::aes(x=mpg, y=am, label=rownames(mtcars))) +
      ggplot2::geom_text(ggplot2::aes(colour=factor(cyl)), size = 3) +
      ggplot2::scale_colour_discrete(l=40)
g3
```


```{r}
pairs(mtcars, main = "mtcars data")
coplot(mpg ~ disp | as.factor(cyl), data = mtcars,
        panel = panel.smooth, rows = 1)
```


## How the transmission system affects the Miles/(US) gallon

Automatic trassmission with low gears (3) have a bad performance comparing with 4 gears in manual transmission. However, the tendency shows that manual transmissions with higher gears have more variablity and worser performance.

Also, new automatic systems with 4 gears, have a better performance in consume with higher gears.


```{r}
spm(~ hp + cyl | mpg,data = mtcars)
```

```{r}
coplot(mpg ~ amS | as.factor(cyl), data = mtcars,
        panel = panel.smooth, rows = 1)
```

```{r}
coplot(mpg ~ gear | amS, data = mtcars,
        panel = panel.smooth, rows = 1)
```

```{r}
spm(~ mpg + round(gear) | amS,data = mtcars,smoother=FALSE)
```

